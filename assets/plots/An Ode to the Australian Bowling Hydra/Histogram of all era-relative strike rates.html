<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Differential Strike Rate by Team</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      width: 100%;
      font-family: "Segoe UI", Arial, sans-serif;
      background: #f5f5f5;
    }

    h2 {
      text-align: center;
      margin: 40px 10px 20px;
      color: #222;
    }

    .chart-container {
      box-sizing: border-box;
      width: 100%;
      max-width: 900px;
      margin: 0 auto 60px;
      background: #fff;
      padding: 20px 30px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      border-radius: 12px;
      text-align: center;
    }

    canvas {
      display: block;
      width: 100% !important;
      height: auto !important;
      max-width: 100%;
    }

    p.caption {
      font-size: 14px;
      color: #555;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <div class="chart-container">
    <canvas id="diffChart"></canvas>
    <p class="caption">
      Highest era-relative strike rates across teams.
    </p>
  </div>

  <script>
    // Example data
    const teams = [
      "2022–2025 Australia (women)",
      "2017–2022 Australia (women)",
      "2022–2025 England (women)",
      "2023–2025 Sri Lanka (men)",
      "2005–2009 South Africa (women)",
      "2003–2007 Australia (men)",
      "2011–2015 South Africa (men)",
      "2007–2011 Australia (men)",
      "2019–2023 India (men)",
      "2015–2019 India (men)",
      "2015–2019 New Zealand (men)",
      "2015–2019 South Africa (men)"
    ];

    const diffStrike = [
      6.77, 5.91, 5.87,
      5.80, 4.82, 4.80, 4.33, 3.83, 
      3.47, 3.38, 3.36, 3.34
    ];

    const backgroundColors = diffStrike.map(v =>
      v < -5 ? "rgba(255, 99, 132, 0.7)" : "rgba(54, 162, 235, 0.7)"
    );

    // Dynamically calculate canvas height
    const barHeight = 40; // pixels per bar
    const canvas = document.getElementById('diffChart');
    canvas.height = teams.length * barHeight;

    const ctx = canvas.getContext('2d');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: teams,
        datasets: [{
          label: 'Era-relative Strike Rate',
          data: diffStrike,
          backgroundColor: backgroundColors,
          borderColor: 'rgba(0, 0, 0, 0.3)',
          borderWidth: 1.2,
          borderRadius: 6,
          barPercentage: 0.8,
          categoryPercentage: 0.8
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false, // allows dynamic height
        plugins: {
          legend: { display: false },
          title: {
            display: true,
            text: 'Histogram of Era-relative Strike Rates',
            color: '#333',
            font: { size: 16, weight: 'bold' }
          },
          tooltip: {
            callbacks: {
              title: function() { return ''; },
              label: function(context) {
                return context.raw.toFixed(2);
              }
            }
          }
        },
        scales: {
          x: {
            title: { display: true, text: 'Era-relative Strike Rate' },
            beginAtZero: true,
            grid: { color: 'rgba(0,0,0,0.05)' }
          },
          y: {
            title: { display: true, text: 'Team' },
            grid: { color: 'rgba(0,0,0,0.05)' },
            ticks: { autoSkip: false }
          }
        }
      }
    });
  </script>

</body>
<script>
  function sendHeightToParent() {
    const height = document.documentElement.scrollHeight;
    window.parent.postMessage({ type: 'setHeight', height }, '*');
  }

  window.addEventListener('load', sendHeightToParent);
  window.addEventListener('resize', sendHeightToParent);
</script>
</html>

