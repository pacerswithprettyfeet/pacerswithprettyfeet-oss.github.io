<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bowler Radar Chart</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 50px auto;
      text-align: center;
      background-color: #f4f4f4;
    }
    canvas {
      background: #ffffff;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>
<body>
  <!-- <h2>Economy, strike rate and average of Australian bowlers since the conclusion of the 2022 World Cup</h2> -->
  <canvas id="radarChart" width="600" height="600"></canvas>
  <p style="text-align:center; font-size:14px; color:#555; margin-top:2px;">
   Opposition-relative strike rate is the difference in the rate in which a team loses 
   wickets and takes wickets. Similarly, opposition-relative economy and average is the 
   difference in the economy rates and the average of the opposition compared to the economy 
   and average of the team. The two Australian women team outshine all teams from history in 
   terms of opposition-relative economy rates.
  </p>

  <script>
    const bowlers = [
      '2022–2025 (women) Australia',
      '2017–2022 (women) Australia',
      '2015–2019 England',
      '2022–2025 (women) England',
      '2019–2023 India',
      '2003–2007 Australia',
      '2011–2015 Australia'
    ];


    const economy = [1.048214564, 1.33755663, 0.404289303, 1.029779374, 0.274247986, 0.266074748, 0.097570097];
    const strikeRate = [13.76297356, 23.16220096, 7.826691633, 8.398693985, 15.61691484, 12.77860297, 7.581706408];
    const average = [18.06442384, 28.37464115, 10.59262065, 12.77030913, 16.28227019, 12.57641796, 7.030709762];

    const metrics = [
      { name: 'Era-relative Economy', data: economy },
      { name: 'Era-relative Strike Rate', data: strikeRate },
      { name: 'Era-relative Average', data: average }
    ];

    // Normalize with padding
    function normalizeWithPadding(arr, scaleMax = 90, padding = 0.1) {
      const min = Math.min(...arr);
      const max = Math.max(...arr);
      const range = max - min;
      const paddedMin = min - range * padding;
      const paddedMax = max + range * padding;
      return arr.map(v => ((v - paddedMin) / (paddedMax - paddedMin)) * scaleMax);
    }

    // Normalize all metrics
    const normalizedData = metrics.map(m => normalizeWithPadding(m.data));

    const colors = [
      '#1f77b4', '#ff7f0e', '#2ca02c', '#d62728',
      '#9467bd', '#8c564b', '#e377c2'
    ];

    const radarData = {
      labels: metrics.map(m => m.name),
      datasets: bowlers.map((b, i) => ({
        label: b,
        data: normalizedData.map(m => m[i]),
        fill: true,
        backgroundColor: colors[i] + '55',
        borderColor: colors[i],
        borderWidth: 2,
        pointRadius: 4,
        pointBackgroundColor: colors[i]
      }))
    };

    const radarConfig = {
      type: 'radar',
      data: radarData,
      options: {
        scales: {
          r: {
            min: 0,
            max: 90,
            ticks: {
              display: false,
              stepSize: 15,
              color: '#555',
              backdropColor: 'transparent'
            },
            grid: { color: '#bbb' },
            angleLines: { color: '#888' },
            pointLabels: { font: { size: 14, weight: 'bold' } }
          }
        },
        plugins: {
          legend: { position: 'top' },
          title: {
            display: true,
            text: 'Opposition relative strike rate, economy and average of select teams.'
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const i = context.datasetIndex;
                const idx = context.dataIndex;
                let value;
                if (idx === 0) value = economy[i];
                else if (idx === 1) value = strikeRate[i];
                else value = average[i];
                return `${context.dataset.label} — ${context.label}: ${value.toFixed(2)}`;
              }
            }
          }
        }
      },
      plugins: [{
        id: 'customAxisLabels',
        afterDraw: (chart) => {
          const { ctx, scales: { r } } = chart;
          const centerX = r.xCenter;
          const centerY = r.yCenter;
          const radius = r.drawingArea;

          ctx.save();
          ctx.fillStyle = '#333';
          ctx.font = '12px Arial';
          ctx.textAlign = 'center';

          // Draw axis labels for each metric
          metrics.forEach((m, i) => {
            const angle = (Math.PI * 2 / metrics.length) * i - Math.PI / 2;
            const min = Math.min(...m.data);
            const max = Math.max(...m.data);
            for (let j = 1; j <= 5; j++) {
              const frac = j / 5;
              const value = min + frac * (max - min);
              const x = centerX + Math.cos(angle) * radius * frac;
              const y = centerY + Math.sin(angle) * radius * frac;
              ctx.fillText(value.toFixed(1), x, y);
            }
          });

          ctx.restore();
        }
      }]
    };

    new Chart(document.getElementById('radarChart'), radarConfig);
  </script>
</body>
</html>
