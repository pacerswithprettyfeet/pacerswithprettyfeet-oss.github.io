<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bowler Differential Scatter Plot</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
  font-family: Arial, sans-serif;
  max-width: 1000px;
  margin: 50px auto;
  text-align: center;
}
canvas {
  background: #f9f9f9;
  border-radius: 15px;
  padding: 20px;
}
.checkbox-container {
  margin: 20px 0;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
}
.checkbox-container label {
  margin-left: 5px;
  font-weight: bold;
}
</style>
</head>
<body>

<div class="checkbox-container" id="checkboxContainer"></div>
<canvas id="scatterChart" width="700" height="500"></canvas>
<p style="text-align:center; font-size:14px; color:#555; margin-top:2px;">
  Era-relative numbers of all bowlers: Clicking through teams from different bowling 
  units toggles the stats of their bowlers on and off 
</p>

<script>
// Team data
const teams = {
  Australia1: {
    display: "2022â€“2025 (women) Australia",
    color: "rgba(255, 206, 86, 0.7)", // yellow
    bowlers: [
      { name: "ML Schutt", diffSR: 0.039392665, diffEcon: 0.193375461 },
      { name: "D Brown", diffSR: -4.434455674, diffEcon: -0.523123597 },
      { name: "JL Jonassen", diffSR: 7.101404091, diffEcon: 0.984043932 },
      { name: "A Sutherland", diffSR: 5.727840704, diffEcon: 0.102718696 },
      { name: "A King", diffSR: 11.69959629, diffEcon: 0.262404957 },
      { name: "A Gardner", diffSR: 9.214694699, diffEcon: 0.455826139 },
      { name: "G Wareham", diffSR: 0.615637215, diffEcon: 0.168816707 },
      { name: "KJ Garth", diffSR: 10.79319435, diffEcon: 0.547038852 },
      { name: "S Molineux", diffSR: 9.46859684, diffEcon: 0.352927618 },
    ]
  },
  Australia2: {
    display: "2017â€“2022 (women) Australia",
    color: "rgba(75, 192, 192, 0.7)",
    bowlers: [
      { name: "ML Schutt", diffSR: -7.066873295, diffEcon: -0.15235906 },
      { name: "HL Ferling", diffSR: 4.719567124, diffEcon: 0.378841315 },
      { name: "KM Beams", diffSR: -6.282409097, diffEcon: -0.481230406 },
      { name: "EA Perry", diffSR: -1.59383138, diffEcon: 0.2681761 },
      { name: "GM Harris", diffSR: -10.4079255, diffEcon: -0.888771293 },
      { name: "JL Jonassen", diffSR: -1.782739803, diffEcon: -0.483908695 },
      { name: "RM Farrell", diffSR: 51.04403226, diffEcon: 0.181255881 },
      { name: "A Wellington", diffSR: -1.035462755, diffEcon: 0.599419522 },
      { name: "EA Osborne", diffSR: -3.697237417, diffEcon: -0.111790351 },
      { name: "L Cheatle", diffSR: 3.885064161, diffEcon: 1.318048943 },
      { name: "TM McGrath", diffSR: 2.746642978, diffEcon: 0.158786075 },
      { name: "NJ Carey", diffSR: -0.671316847, diffEcon: -0.510839543 },
      { name: "G Wareham", diffSR: -2.280427485, diffEcon: -0.05044567 },
      { name: "S Molineux", diffSR: -13.28713495, diffEcon: -1.424377703 },
      { name: "TJ Vlaeminck", diffSR: 18.63981598, diffEcon: 0.062026021 },
      { name: "A Sutherland", diffSR: -8.181118819, diffEcon: 0.118361134 },
      { name: "A King", diffSR: 1.615430134, diffEcon: -1.212268382 },
      { name: "SJ Coyte", diffSR: 19.11584748, diffEcon: -0.018863923 },
      { name: "JL Hunter", diffSR: 6.566058651, diffEcon: -0.18391264 }
    ]
  },
  England1: {
    display: "2022â€“2025 (women) England",
    color: "rgba(153, 102, 255, 0.7)",
    bowlers: [
      { name: "A Shrubsole", diffSR: -8.154665233, diffEcon: -0.083683584 },
      { name: "KH Brunt", diffSR: 28.89753804, diffEcon: -0.192848018 },
      { name: "NR Sciver-Brunt", diffSR: 21.50109349, diffEcon: -0.181812563 },
      { name: "KL Cross", diffSR: 4.931514949, diffEcon: -0.056878829 },
      { name: "S Ecclestone", diffSR: -9.808725472, diffEcon: -1.281077366 },
      { name: "CE Dean", diffSR: -10.61617648, diffEcon: -0.120264133 },
      { name: "LK Bell", diffSR: -5.277873419, diffEcon: 0.696450316 },
      { name: "IECM Wong", diffSR: -7.522514919, diffEcon: 1.794976123 },
      { name: "AN Davidson-Richards", diffSR: -11.55960243, diffEcon: 0.815035699 },
      { name: "FG Kemp", diffSR: -11.72943979, diffEcon: 0.911189043 },
      { name: "S Glenn", diffSR: -9.733064746, diffEcon: -0.27255442 },
      { name: "L Filer", diffSR: -9.809994946, diffEcon: 0.568555021 },
      { name: "HL Baker", diffSR: -4.114806246, diffEcon: 1.20349398 },
      { name: "MK Villiers", diffSR: -18.26049317, diffEcon: 0.526350559 },
      { name: "LCN Smith", diffSR: -14.17376928, diffEcon: -1.025768002 }
    ]
  }
};

// ðŸ”„ Flip all numbersâ€™ signs dynamically
for (const team of Object.values(teams)) {
  for (const bowler of team.bowlers) {
    bowler.diffSR *= -1;
    bowler.diffEcon *= -1;
  }
}

// Create datasets
const datasets = Object.keys(teams).map((teamName) => ({
  label: teams[teamName].display,
  data: teams[teamName].bowlers.map(b => ({ x: b.diffSR, y: b.diffEcon, label: b.name })),
  backgroundColor: teams[teamName].color,
  pointRadius: 6,
  hidden: false
}));

// Calculate global axis limits
const allX = datasets.flatMap(ds => ds.data.map(p => p.x));
const allY = datasets.flatMap(ds => ds.data.map(p => p.y));
const xMin = Math.min(...allX) - 2;
const xMax = Math.max(...allX) + 2;
const yMin = Math.min(...allY) - 0.5;
const yMax = Math.max(...allY) + 0.5;

const scatterConfig = {
  type: 'scatter',
  data: { datasets },
  options: {
    responsive: true,
    animation: false,
    plugins: {
      legend: { display: false },
      tooltip: {
        callbacks: {
          label: ctx => {
            const { label, x, y } = ctx.raw;
            return `${label}: SR Diff = ${x.toFixed(2)}, Econ Diff = ${y.toFixed(2)}`;
          }
        }
      },
      title: {
        display: true,
        text: "Era-relative strike rate and economy (signs inverted)"
      }
    },
    scales: {
      x: {
        title: { display: true, text: "Era-relative Strike Rate" },
        min: xMin - 4,
        max: xMax + 4,
        grid: {
          color: ctx => (ctx.tick.value === 0 ? "black" : "#ccc"),
          lineWidth: ctx => (ctx.tick.value === 0 ? 2 : 1)
        }
      },
      y: {
        title: { display: true, text: "Era-relative Economy" },
        min: yMin,
        max: yMax,
        grid: {
          color: ctx => (ctx.tick.value === 0 ? "black" : "#ccc"),
          lineWidth: ctx => (ctx.tick.value === 0 ? 2 : 1)
        }
      }
    }
  },
  plugins: [{
    id: 'scatterLabels',
    afterDatasetsDraw(chart) {
      const { ctx, data } = chart;
      ctx.save();
      data.datasets.forEach((dataset, i) => {
        if (!dataset.hidden) {
          const meta = chart.getDatasetMeta(i);
          dataset.data.forEach((point, idx) => {
            const px = meta.data[idx].x;
            const py = meta.data[idx].y;
            ctx.fillStyle = "black";
            ctx.font = "12px Arial";
            ctx.textAlign = "left";
            ctx.fillText(point.label, px + 6, py - 6);
          });
        }
      });
      ctx.restore();
    }
  }]
};

const scatterChart = new Chart(document.getElementById('scatterChart'), scatterConfig);

// Create checkboxes
const checkboxContainer = document.getElementById('checkboxContainer');
Object.keys(teams).forEach((teamName, index) => {
  const checkbox = document.createElement('input');
  checkbox.type = 'checkbox';
  checkbox.checked = true;
  checkbox.id = `team-${index}`;
  checkbox.dataset.datasetIndex = index;

  const label = document.createElement('label');
  label.htmlFor = checkbox.id;
  label.innerText = teams[teamName].display;
  label.style.color = teams[teamName].color.replace("0.7", "1");

  checkbox.addEventListener('change', () => {
    const datasetIndex = checkbox.dataset.datasetIndex;
    scatterChart.data.datasets[datasetIndex].hidden = !checkbox.checked;
    scatterChart.update();
  });

  const container = document.createElement('div');
  container.appendChild(checkbox);
  container.appendChild(label);
  checkboxContainer.appendChild(container);
});
</script>

</body>
</html>
